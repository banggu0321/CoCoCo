<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<div id="teamImg" th:if="${team.teamImg}">
		<img th:src="${team.teamImg}" th:alt="${team.teamImg}" class="showImg rounded">
		<img id="delImg" th:src="@{/images/deleteTeamImg.svg}">
	</div>
	<img th:if="${team.teamImg==null}" th:src="@{/images/teamImg.png}" alt="null" class="showImg rounded">
	
	<div id="teamInfo">
		<form id="modifyForm" action="/admin/modify" method="post" enctype="multipart/form-data">
			<input type="hidden" name="teamId" th:value="${team.teamId}">
			<div class="form-group">
				<label>WORKSPACE NAME</label>
				<input type="text" name="teamName" class="form-control" th:value="${team.teamName}">
			</div>
			
			<div class="form-group">
				<label>WORKSPACE INFO</label>
				<textarea class="form-control" name="teamInfo" rows="2">[[${team.teamInfo}]]</textarea>
			</div>
			
			<div class="form-group">
				<label>WORKSPACE IMAGE</label>
				<input type="file" name="newPhoto" id="img" class="form-control" accept="image/*">
			</div>
			
			<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
			
			<input type="submit" class="btn btn-cococo" value="수정">
			<input type="button" class="btn btn-light reloadBtn" value="취소">
		</form>
	</div>
	
<style>
input[type=file] {
    padding: 3px;
}
</style>

<script>
$(function() {
	$("#modifyForm").submit(isEmpty);
	$("#delImg").click(deleteImg);
	$(".reloadBtn").click(reload);
	$("#img").change(makeView);
})

function isEmpty() {
	var teamName = $("input[name='teamName']");
	if(teamName.val() == "") {
		alert("워크스페이스 이름은 필수입니다!");
		teamName.focus();
		return false; 
	}
}

function deleteImg() {
	if(confirm("이미지를 삭제하시겠습니까?")) {
		$.ajax({
			type:"get",
			url:"/admin/deleteImg",
			success: function() {
				$(".showImg").attr("src", "/images/teamImg.png");
				$("#delImg").hide();
			}
		});
	}
}

function reload() {
	location.reload();
}
	
function makeView(e) {
	var reader = new FileReader();

	reader.onload = function(e) {
		$(".showImg").attr("src", e.target.result);
	};

	reader.readAsDataURL(e.target.files[0]);
}
	
</script>
</html>