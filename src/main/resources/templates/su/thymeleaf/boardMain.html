<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="~{/layout/layout1}"
>
<head>
<style>

#boardMain{
	width: 900px;
	margin: 0 auto;
	margin-top: 5%;
}

#boardMain1{
display: flex;
margin-bottom: -15px;  

}
#boardMainSub1{
position:relative;
left:10%;
;
}
#boardMainSub2{
text-align:right;

position:relative;
left:45%;
}
#boardMain2{
margin: 0 auto;
width:80%;
background: white
}
#boardMainNav{
display: flex;
justify-content: center;
}
</style>
<style>
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  position: relative;
  background-color: #fefefe;
  margin: auto;
  padding: 0;
  width: 70%;
  
  -webkit-animation-name: animatetop;
  -webkit-animation-duration: 0.4s;
  animation-name: animatetop;
  animation-duration: 0.4s
}

/* Add Animation */
@-webkit-keyframes animatetop {
  from {top:-300px; opacity:0} 
  to {top:0; opacity:1}
}

@keyframes animatetop {
  from {top:-300px; opacity:0}
  to {top:0; opacity:1}
}
</style>
<meta charset="utf-8">
<title>board main page</title>
</head>
<body>


<div layout:fragment="inner_content"  class="inner_content">
	<div id="boardMain">
		<div id="boardMain1">
			<div id="boardMainSub1">
				<button id="boardFormA">A form</button>
				-
				<button>B form</button>
			</div>

			<div id="boardMainSub2">
				<button id="boardCategory" type="button" class="btn btn-primary">카테고리
					선택</button>
				<button id="insertBoard" type="button" class="btn btn-primary">게시판
					만들기</button>
			</div>
		</div><br><br>
		
		<div id="boardMain2">
			<table class="table table-hover">
				<thead>
					<tr>
						<th>제목</th>
						<th>추가 일시</th>
						<th>수정 일시</th>
						<th>작성자</th>
					</tr>
				</thead>
				<tbody id="replyTable"></tbody>
			</table>

			<nav id="boardMainNav">
				<ul class="pagination">
				
					<li th:if="${result.prevPage}" class="page-item"><a href="#" class="page-link">PREV</a></li>
					<li th:each="p:${result.pageList}" class="page-item"><a id="navPage" class="page-link">[[${p.pageNumber}+1]]</a></li>
					<li th:if="${result.nextPage}" class="page-item"><a id="nextPagelist" class="page-link">[[${result.nextPage.getPageNumber()}]]</a></li>
				</ul>
			</nav>
		</div>
	</div>


	<!-- Modal -->
	<div id="myModal" class="modal">

		<!-- Modal content -->
		<div class="modal-content">
			<div class="modal-header">
			<h5>카테고리 목록</h5>
			<span id="closeModal" class="close">&times;</span>	
			</div>
			<div class="modal-body">
			카테고리 이름: 
			<select id="categoryTable"></select>
			<button id="categoryNameBtn">선택</button><br><br>
			
			카테고리 이름: 
			<input type="text" id="cNameInsert">
			<button id="cNameInsertBtn">적용하기</button>
			</div>
		</div>

	</div>


	<script th:inline="javascript" th:src="@{'js/RESTreply.js'}"></script>
	<script th:inline="javascript">	
	var insertName = document.getElementById("cNameInsert");
	var insertNameBtn = document.getElementById("cNameInsertBtn");
	
	var insertBtn = document.getElementById("insertBoard");
	var categoryBtn = document.getElementById("boardCategory");
	
	var modal = document.getElementById("myModal");
	var modalClose = document.getElementById("closeModal");
	
	var categoryName = document.getElementById("categoryTable");
	var cNameBtn = document.getElementById("categoryNameBtn");
	
	var formA = document.getElementById("boardFormA");
	var categoryResult;
	var showCategory = document.getElementById("scName");
	
	var formObj = document.querySelectorAll("#navPage");
	for(let i=0; i<formObj.length; i++){
		formObj[i].addEventListener('click', ()=>{
			alert("a tag clicked"+formObj[i].innerText);
			replyREST.getBoardPage(formObj[i].innerText, printList);
		});
	}
	
	var navPageList = document.getElementById("nextPagelist");	
	</script>

	<script th:inline="javascript">
		formA.onclick = function() {
			alert("form clicked");
		}
		
		navPageList.onclick = function(){
			let temp = navPageList.text;
			alert("next pagelist clicked: "+temp);
			
			//location.href="/getNextBoard/"+temp;
		}


		insertNameBtn.onclick = function() {
			alert(insertName.value);

			replyREST.getAllBoard("boardList/insertName/" + insertName.value,
					printList);
			modal.style.display = "none";
		}

		categoryBtn.onclick = function() {
			modal.style.display = "block";
			replyREST.getAllCategory("categoryName", printCategory);
		}

		cNameBtn.onclick = function() {
			categoryResult = categoryName.options[categoryName.selectedIndex].text;
			replyREST.getAllBoard("boardList/" + categoryResult, printList);

			modal.style.display = "none";
		};

		modalClose.onclick = function() {
			modal.style.display = "none";
		};

		insertBtn.onclick = function() {

			if (categoryResult == null) {
				alert("카테고리를 선택하세요.");
			} else if (categoryResult != null) {
				location.href = "/boardInsertSample2/" + categoryResult;
			}
		};

		$(document).ready(function() {
			replyREST.getAllBoard("boardList", printList);
		});
	</script>
	<script th:inline="javascript">		
		function printCategory(list) {
			var result = "";
			var obj;

			for (var i = 0; i < list.length; i++) {
				obj = list[i];
				result += "<option>" + obj + "</option>"
			}
			$("#categoryTable").html(result);
		}
		
		function printList(list) {
			var str = "";
			var replyObj;

			if (list.length == 0) {
				alert("list is null");
				str += "<tr>"+"<td colspan='4'>"+"<center>"+"만든 게시글 없습니다."+"</center>"+"</td>"+"</tr>";
			} else if (list.length != 0) {

				for (var i = 0; i < list.length; i++) {
					replyObj = list[i];

					str += "<tr>" + "<td>" + "<a href='/boardUDsampleBeta?id="
							+ replyObj.boardId + "'>" + replyObj.boardTitle
							+ "</a>" + "</td>" + "<td>"
							+ formatDate(replyObj.boardRegDate) + "</td>"
							+ "<td>" + formatDate(replyObj.boardUpdate)
							+ "</td>" + "<td>" + replyObj.user.name + "</td>"
							+ "</tr>";
				}
			}
			$("#replyTable").html(str);
		}
		function formatDate(timeValue) {
			var date = new Date(timeValue);
			return date.getFullYear() + "-" + (date.getMonth() + 1) + "-"
					+ date.getDate();
		}
	</script>
</div>
</body>
</html>