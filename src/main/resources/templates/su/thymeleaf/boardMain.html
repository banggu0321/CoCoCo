<!DOCTYPE html>
<html xmlns:th="www.thymeleaf.org">
<head>
<style>
#boardMain{
margin: 0 auto;
width: 70%;
}
#boardMain1{
display: flex;
margin-bottom: -15px;  
}
#boardMainSub1{
position:relative;
left:10%;
}
#boardMainSub2{
text-align:right;

position:relative;
left:30%;
}
#boardMain2{
margin: 0 auto;
width:80%;
}
</style>
<style>
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  position: relative;
  background-color: #fefefe;
  margin: auto;
  padding: 0;
  width: 70%;
  
  -webkit-animation-name: animatetop;
  -webkit-animation-duration: 0.4s;
  animation-name: animatetop;
  animation-duration: 0.4s
}

/* Add Animation */
@-webkit-keyframes animatetop {
  from {top:-300px; opacity:0} 
  to {top:0; opacity:1}
}

@keyframes animatetop {
  from {top:-300px; opacity:0}
  to {top:0; opacity:1}
}
</style>
<meta charset="utf-8">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<title>board main page</title>
</head>
<body>

	<div id="boardMain">
		<div id="boardMain1">
			<div id="boardMainSub1">
				category name - <button id="boardFormA">A form</button> - <button>B form</button>
			</div>
			
			<div id="boardMainSub2">
			<button id="sampleBtn">sample</button>
			<button id="boardCategory" type="button" class="btn btn-primary">카테고리 선택</button>
			<button id="insertBoard" type="button" class="btn btn-primary">게시판 만들기</button>
			</div>
		</div>
		<hr>

		<div id="boardMain2">
			<table class="table table-hover">
				<thead>
					<tr>
						<th>제목</th>
						<th>추가 일시</th>
						<th>수정 일시</th>
						<th>작성자</th>
					</tr>
				</thead>
				<tbody id="replyTable"></tbody>
			</table>
		</div>
	</div>


	<!-- Modal -->
	<div id="myModal" class="modal">

		<!-- Modal content -->
		<div class="modal-content">
			<div class="modal-header">
				<span id="closeModal" class="close">&times;</span>
				<h5>카테고리 목록</h5>
			</div>
			<div class="modal-body">
			카테고리 이름: 
			<select id="categoryTable"></select>
			<button id="categoryNameBtn">선택</button>
			</div>
		</div>

	</div>


	<script th:inline="javascript" th:src="@{'js/RESTreply.js'}"></script>
	<script th:inline="javascript">
	
	var insertBtn = document.getElementById("insertBoard");
	var categoryBtn = document.getElementById("boardCategory");
	
	var modal = document.getElementById("myModal");
	var modalClose = document.getElementById("closeModal");
	
	var categoryName = document.getElementById("categoryTable");
	var cNameBtn = document.getElementById("categoryNameBtn");
	
	var formA = document.getElementById("boardFormA");
	formA.onclick = function(){
		alert("form clicked");
	}


		categoryBtn.onclick = function() {
			modal.style.display = "block";
			replyREST.getAllCategory("categoryName", printCategory);
		}

		cNameBtn.onclick = function() {
			let categoryResult = categoryName.options[categoryName.selectedIndex].text;
			replyREST.getAllBoard("boardList/" + categoryResult, printList);

			modal.style.display = "none";
		};

		modalClose.onclick = function() {
			modal.style.display = "none";
		};
		insertBtn.onclick = function() {
			location.href = "/boardInsertSample2";
		};

		function printCategory(list) {
			var result = "";
			var obj;

			for (var i = 0; i < list.length; i++) {
				obj = list[i];
				result += "<option>" + obj + "</option>"
			}
			$("#categoryTable").html(result);
		}
	</script>
	<script th:inline="javascript">
		$(document).ready(function() {
			replyREST.getAllBoard("boardList", printList);
		});
		function printList(list) {
			var str = "";
			var replyObj;

			for (var i = 0; i < list.length; i++) {
				replyObj = list[i];

				str += "<tr>" + "<td>" + "<a href='/boardUDsampleBeta?id="
						+ replyObj.boardId + "'>" + replyObj.boardTitle
						+ "</a>" + "</td>" + "<td>" + formatDate(replyObj.boardRegDate)
						+ "</td>" + "<td>" + formatDate(replyObj.boardUpdate)
						+ "</td>"+ "<td>" + replyObj.user.name
						+ "</td>"  + "</tr>";
			}
			$("#replyTable").html(str);
		}
		function formatDate(timeValue) {
			var date = new Date(timeValue);
			return date.getFullYear() + "-" + (date.getMonth() + 1) + "-"
					+ date.getDate();
		}
	</script>
</body>
</html>